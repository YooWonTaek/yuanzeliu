{% include base_path %}

<!-- start custom head snippets -->

<!-- Support for Academicons -->
<link rel="stylesheet" href="{{ base_path }}/assets/css/academicons.css"/>

<!-- favicon from https://commons.wikimedia.org/wiki/File:OOjs_UI_icon_academic-progressive.svg -->
<link rel="apple-touch-icon" sizes="180x180" href="{{ base_path }}/images/apple-touch-icon-180x180.png"/>
<link rel="icon" type="image/svg+xml" href="{{ base_path }}/images/favicon.svg"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-32x32.png" sizes="32x32"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-192x192.png" sizes="192x192"/>
<link rel="manifest" href="{{ base_path }}/images/manifest.json"/>
<link rel="icon" href="/images/favicon.ico"/>
<meta name="theme-color" content="#ffffff"/>

<script>
/* Force external links to open in a new tab (works even if other scripts run later) */
(function () {
  var HOST = location.hostname;

  // Helper: is this anchor an external http(s) link?
  function isExternal(a) {
    if (!a || !a.href) return false;
    var href = a.getAttribute('href') || '';
    if (!href || href[0] === '#' ||
        href.startsWith('mailto:') ||
        href.startsWith('tel:') ||
        href.startsWith('javascript:')) return false;
    try { return a.hostname && a.hostname !== HOST; } catch(e) { return false; }
  }

  // 1) Retarget all existing links after page load
  function retargetAll() {
    var links = document.getElementsByTagName('a');
    for (var i = 0; i < links.length; i++) {
      var a = links[i];
      if (isExternal(a)) {
        a.target = '_blank';
        a.rel = (a.rel ? a.rel + ' ' : '') + 'noopener noreferrer';
      }
    }
  }
  window.addEventListener('load', retargetAll);

  // 2) Intercept future clicks (CAPTURE PHASE) and open external links in a new tab
  document.addEventListener('click', function (e) {
    var t = e.target;
    var a = t && (t.closest ? t.closest('a') : (t.tagName === 'A' ? t : null));
    if (!a) return;
    if (isExternal(a)) {
      e.preventDefault();                    // stop same-tab navigation
      window.open(a.href, '_blank', 'noopener'); // open in new tab safely
    }
  }, true); // <-- capture phase so we run before other handlers
})();
</script>


<!-- end custom head snippets -->
