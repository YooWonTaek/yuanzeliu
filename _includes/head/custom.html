{% include base_path %}

<!-- start custom head snippets -->

<!-- Support for Academicons -->
<link rel="stylesheet" href="{{ base_path }}/assets/css/academicons.css"/>

<!-- favicon from https://commons.wikimedia.org/wiki/File:OOjs_UI_icon_academic-progressive.svg -->
<link rel="apple-touch-icon" sizes="180x180" href="{{ base_path }}/images/apple-touch-icon-180x180.png"/>
<link rel="icon" type="image/svg+xml" href="{{ base_path }}/images/favicon.svg"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-32x32.png" sizes="32x32"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-192x192.png" sizes="192x192"/>
<link rel="manifest" href="{{ base_path }}/images/manifest.json"/>
<link rel="icon" href="/images/favicon.ico"/>
<meta name="theme-color" content="#ffffff"/>

<script>
/* Open all external links in a new tab (robust, runs multiple times) */
(function () {
  function setExternalTargets(root) {
    var host  = location.hostname;
    var links = (root || document).querySelectorAll('a[href]');

    links.forEach(function(a){
      var href = a.getAttribute('href') || '';
      // Skip anchors & non-http(s)
      if (!href || href[0]==='#' || href.startsWith('mailto:') ||
          href.startsWith('tel:') || href.startsWith('javascript:')) return;

      // Consider external if hostname differs
      if (a.hostname && a.hostname !== host) {
        a.target = '_blank';
        // keep existing rel values
        if (!a.rel || !/noopener/i.test(a.rel)) {
          a.rel = (a.rel ? a.rel + ' ' : '') + 'noopener noreferrer';
        }
      }
    });
  }

  // Run at multiple lifecycle points
  document.addEventListener('DOMContentLoaded', function(){ setExternalTargets(document); });
  window.addEventListener('load', function(){ setExternalTargets(document); });

  // Also handle content injected after load
  var mo = new MutationObserver(function(muts){
    for (var m of muts) if (m.addedNodes && m.addedNodes.length) {
      setExternalTargets(document);
      break;
    }
  });
  mo.observe(document.documentElement, { childList: true, subtree: true });
})();
</script>

<!-- end custom head snippets -->
